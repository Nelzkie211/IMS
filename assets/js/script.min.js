function toDo(){var e=window.localStorage.getItem("nav"),t=window.localStorage.getItem("sect");null==e?($("#homeSection").show(),$("#home").removeClass("text-white"),$("#home").addClass("text-danger")):($("section").hide(),$("#"+t).show(),$("a.nav-link").removeClass("text-danger"),$("a.nav-link").addClass("text-white"),$("#"+e).removeClass("text-white"),$("#"+e).addClass("text-danger"));var a=document.querySelector(".itemClass1"),n=document.querySelector(".itemClass2");"itemList"===window.localStorage.getItem("nav")?($("#transactTable").DataTable().clear().destroy(),itemTable()):"inventory"===window.localStorage.getItem("nav")?($("#itemTable").DataTable().clear().destroy(),transactTable(),a.style.display="none",n.style.display="none"):(a.style.display="none",n.style.display="none")}function keyFunc(){function e(){$.ajax({type:"post",url:"addItem",dataType:"json",data:{desc:t.value,units:a.value,itemId:n.value},success:e=>{document.getElementById("itemId").value="",document.getElementById("desc").value="",document.getElementById("units").value="",$("#exampleModal").modal("show"),document.getElementById("alertSpan").innerHTML="Success...",setTimeout(function(){$("#exampleModal").modal("hide"),document.getElementById("desc").focus()},1e3),itemTable()},error:e=>{alert("error")}})}var t=document.getElementById("desc"),a=document.getElementById("units"),n=document.getElementById("itemId"),l=document.getElementById("insertItem");document.addEventListener("keydown",function(n){switch(n.keyCode){case 37:a===document.activeElement?(document.getElementById("desc").focus(),document.getElementById("units").blur()):l===document.activeElement&&(document.getElementById("insertItem").blur(),document.getElementById("units").focus());break;case 39:t===document.activeElement?(document.getElementById("desc").blur(),document.getElementById("units").focus()):a===document.activeElement&&(document.getElementById("unit").blur(),document.getElementById("insertItem").focus());break;case 13:l!==document.activeElement&&a!==document.activeElement||e()}}),l.addEventListener("click",()=>{e()})}function itemTable(){$("#itemTable").DataTable().clear().destroy(),$("#itemTable").DataTable({processing:!0,serverSide:!0,pagingType:"first_last_numbers",ajax:{url:"getItem",type:"post",dataType:"json"},order:[[0,"desc"]],bLengthChange:!1,responsive:!0,columnDefs:[{orderable:!1,targets:-1}]})}function transactTable(){$("#transactTable").DataTable().clear().destroy(),$("#transactTable").DataTable({processing:!0,serverSide:!0,pagingType:"first_last_numbers",ajax:{url:"getTransactItem",type:"post",dataType:"json"},order:[[0,"desc"]],bLengthChange:!1,responsive:!0,columnDefs:[{targets:1,className:"dt-body-right"},{orderable:!1,targets:-1}]})}const home=document.querySelector("#home"),dashboard=document.querySelector("#dashboard"),inventory=document.querySelector("#inventory"),itemList=document.querySelector("#itemList"),addItem=document.querySelector("#addItem");document.addEventListener("DOMContentLoaded",()=>{var e=document.querySelector(".itemClass1"),t=document.querySelector(".itemClass2");e.style.display="none",t.style.display="none",keyFunc(),toDo()}),home.addEventListener("click",()=>{window.localStorage.clear(),window.localStorage.setItem("nav","home"),window.localStorage.setItem("sect","homeSection"),toDo()}),dashboard.addEventListener("click",()=>{window.localStorage.clear(),window.localStorage.setItem("nav","dashboard"),window.localStorage.setItem("sect","dashboardSection"),toDo()}),inventory.addEventListener("click",()=>{window.localStorage.clear(),window.localStorage.setItem("nav","inventory"),window.localStorage.setItem("sect","inventorySection"),toDo()}),itemList.addEventListener("click",()=>{window.localStorage.clear(),window.localStorage.setItem("nav","itemList"),window.localStorage.setItem("sect","itemSection"),toDo(),itemTable()}),$("#itemTable").on("click",".itemEditClass",function(){var e=document.querySelector(".itemClass1"),t=document.querySelector(".itemClass2");e.style.display="",t.style.display="",document.getElementById("desc").focus(),document.getElementById("itemId").value=$(this).data("id"),document.getElementById("desc").value=$(this).data("desc"),document.getElementById("units").value=$(this).data("unit")}),$("#itemTable").on("click",".itemDeleteClass",function(){document.getElementById("itemId").value="",document.getElementById("desc").value="",document.getElementById("units").value="";var e=document.querySelector(".itemClass1"),t=document.querySelector(".itemClass2");e.style.display="none",t.style.display="none",document.getElementById("desc").blur(),document.getElementById("units").blur(),confirm("Are you sure you want to delete? _"+$(this).data("id"))&&$.ajax({type:"post",url:"delItem",dataType:"json",data:{itemId:$(this).data("id")},success:e=>{$("#exampleModal").modal("show"),document.getElementById("alertSpan").innerHTML="Successfully deleted...",setTimeout(function(){$("#exampleModal").modal("hide")},1e3),itemTable()},error:e=>{}})});var addNew=document.getElementById("addNew"),iDesc=document.getElementById("iDesc"),iUnit=document.getElementById("iUnit"),iBalance=document.getElementById("iBalance"),ide=document.getElementById("ide");$("#transactTable").on("click",".itemDepoClass",function(){$("#curBal").show(),"y"!==$(this).data("ident")||($("#modalInvent").modal("show"),document.getElementById("modalInventLabel").innerHTML="Deposit",document.getElementById("forStatus").value="Deposit",iDesc.value=$(this).data("desc"),iUnit.value=$(this).data("unit"),iBalance.value=$(this).data("bal"),ide.value=$(this).data("id"))}),$("#transactTable").on("click",".itemWithdrawClass",function(){$("#curBal").show(),$(this).data("bal")<1?alert("Oops! This item is zero balance."):"y"!==$(this).data("ident")||($("#modalInvent").modal("show"),document.getElementById("modalInventLabel").innerHTML="Withdrawal",document.getElementById("forStatus").value="Withdrawal",iDesc.value=$(this).data("desc"),iUnit.value=$(this).data("unit"),iBalance.value=$(this).data("bal"),ide.value=$(this).data("id"))}),addNew.addEventListener("click",()=>{$("#curBal").hide(),$("#modalInvent").modal("show"),document.getElementById("modalInventLabel").innerHTML="New",document.getElementById("forStatus").value="New"});var iSubmit=document.getElementById("iSubmit"),forStatus=document.getElementById("forStatus");iSubmit.addEventListener("click",()=>{if("New"===forStatus.value)""===iDesc.value||""===iUnit.value?alert("Please fill the fields..."):$.ajax({type:"post",url:"iNew",dataType:"json",data:{desc:iDesc.value,qty:iQuantity.value,unit:iUnit.value},success:e=>{$("#modalInvent").modal("hide"),$("#exampleModal").modal("show"),document.getElementById("alertSpan").innerHTML="Success...",setTimeout(function(){$("#exampleModal").modal("hide")},1e3),transactTable()},error:e=>{alert("error")}});else if("Deposit"===forStatus.value)if(""===iQuantity.value||0===iQuantity.value)alert("Please input Quantity");else{var e=Number(iBalance.value)+Number(iQuantity.value);$.ajax({type:"post",url:"iDeposit",dataType:"json",data:{itemId:ide.value,qty:iQuantity.value,latestBal:e},success:e=>{$("#modalInvent").modal("hide"),$("#exampleModal").modal("show"),document.getElementById("alertSpan").innerHTML="Success...",setTimeout(function(){$("#exampleModal").modal("hide")},1e3),transactTable()},error:e=>{alert("error")}})}else if("Withdrawal"===forStatus.value)if(""===iQuantity.value||0===iQuantity.value)alert("Please input Quantity");else{e=Number(iBalance.value)-Number(iQuantity.value);$.ajax({type:"post",url:"iWithdraw",dataType:"json",data:{itemId:ide.value,qty:iQuantity.value,latestBal:e},success:e=>{$("#modalInvent").modal("hide"),$("#exampleModal").modal("show"),document.getElementById("alertSpan").innerHTML="Success...",setTimeout(function(){$("#exampleModal").modal("hide")},1e3),transactTable()},error:e=>{alert("error")}})}});var iQuantity=document.getElementById("iQuantity");iQuantity.onkeydown=function(e){if(!(e.keyCode>95&&e.keyCode<106||e.keyCode>47&&e.keyCode<58||8==e.keyCode))return!1};var modalInvent=document.getElementById("modalInvent");modalInvent.addEventListener("hidden.bs.modal",()=>{iDesc.value="",iUnit.value="",iBalance.value="",ide.value="",iQuantity.value=""}),modalInvent.addEventListener("shown.bs.modal",()=>{iQuantity.focus();var e=$("#forStatus").val();"Withdrawal"===e?($("#iQuantity").prop("max",Number(iBalance.value)),setTimeout(function(){iQuantity.onkeyup=function(e){Number(iQuantity.value)>Number(iBalance.value)&&(iQuantity.value="")}},500)):($("#iQuantity").prop("max",""),setTimeout(function(){iQuantity.onkeyup=function(e){}},500))});